<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="user-scalable=no,initial-scale=1.0,maximum-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes" />

    <link rel="stylesheet" href="./css/jquery.mobile-1.3.2.min.css">
    <link href="./css/toastr.css" rel="stylesheet"/>

    <script type="text/javascript" charset="utf-8" src="./cordova.js"></script>
    <script type="text/javascript" src="./js/jquery-1.8.3.js"></script>
    <script type="text/javascript" src="./js/jquery.mobile-1.3.2.js"></script>
    <script src="./js/com/json2.js"></script>
    <script src="./js/info.js"></script>
    <script src="./js/com/foodscript.js"></script>
    <style>
        aa{
            text-align:center;
        }
        table{
            width:100%;
            height: 100%
        }
    </style>
</head>

<body>

<div id="foodapp" data-role="page">

    <!--Header-->
    <div id="foodapp_header" data-role="header" data-theme="b">
        <a id="back" data-icon="back" onclick="back()">&nbsp;</a>
        <h1>蔬菜信息助手</h1>
        <a id="add" data-icon="plus" onclick="addList()">&nbsp;</a>
    </div>

    <div id="content" data-role="content">
    </div>

</div>

<div id="list" data-role="page">

    <!--IndexList-->
    <div id="list_item" data-role="content">
        <ul data-role="listview" data-inset="true">
            <li><a id="" href="#" onclick="itemClick('information_list')">
                <img src="images/index/data.jpg">
                <h2>数据传送</h2>
                <p>农产品、基础信息，农资、环境、作业记录</p></a></li>
            <li><a id="" href="#" onclick="scanner('qrScanner')">
                <img src="images/index/barcode.jpg">
                <h2>扫码</h2>
                <p>条形码、二维码</p></a></li>
            <li><a id="" href="#" onclick="itemClick('location_list')">
                <img src="images/index/location.jpg">
                <h2>获取位置信息</h2>
                <p>GPS坐标、定位精度、时间戳等</p></a></li>
            <li><a id="" href="#" onclick="scanner('rfidReader')">
                <img src="images/index/rfid.jpg">
                <h2>RFID</h2>
                <p>rfid</p>
            </a></li>
        </ul>
    </div>

    <!--barcodeList-->
    <div id="barcode_list" data-role="content">

    </div>

    <!--InformationList-->
    <div id="information_list" data-role="content">
        <ul data-role="listview" data-inset="true">
            <li><a id="product_list" href="#" onclick="itemClick('product_list_item')">
                <img src="images/information/product.jpg">
                <h2>农产品、基础信息</h2>
                <p>农产品、基础信息</p></a></li>
            <li><a id="inputs_list" href="#" onclick="itemClick('inputs_list_item')">
                <img src="images/information/inputs.jpg">
                <h2>农资投入</h2>
                <p>肥料、农药、农具等</p></a></li>
            <li><a id="environment_list" href="#" onclick="itemClick('environment_list_item')">
                <img src="images/information/environment.jpg">
                <h2>环境监控</h2>
                <p>种植环境情况</p></a></li>
            <li><a id="operation_list" href="#" onclick="itemClick('operation_list_item')">
                <img src="images/information/operation.jpg">
                <h2>作业记录</h2>
                <p></p>
            </a></li>
        </ul>
    </div>
    <!--LocationList-->
    <div id="location_list" data-role="content">
        <ul data-role="listview" data-inset="true">
            <li data-icon="false"><a id="product_list" href="#" onclick="getPosition()">
                <img src="images/location/locating.jpg">
                <h2>获取当前位置信息</h2>
                <p>获取当前位置信息</p></a></li>
            <li data-icon="false"><a id="inputs_list" href="#" onclick="">
                <img src="images/location/watching.jpg">
                <h2>监控位置变化</h2>
                <p>监控位置变化</p></a></li>
            <li data-icon="false"><a id="environment_list" href="#" onclick="">
                <img src="images/location/clear.jpg">
                <h2>清除监控</h2>
                <p>清除监控</p></a></li>
        </ul>
    </div>

    <!--addList-->
    <div id="addList_Tem" data-role="content" data-theme="d">
        <ul data-role="listview" data-inset="true">
            <li data-icon="false"><a onclick="showAddView('addImage')">添加图片</a></li>
            <li data-icon="false"><a href="">视频</a></li>
            <li data-icon="false"><a href="">扫一扫</a></li>
        </ul>
    </div>

    <!--addImage-->
    <div id="addImage" data-role="content">
        <ul data-role="listview" data-inset="true">
            <li data-icon="false"><a onclick="addImage('getPhoto')">从相册选取</a></li>
            <li data-icon="false"><a onclick="addImage('capturePhoto')">现在拍摄</a></li>
        </ul>
    </div>

    <!--Footer-->
    <div id="footer"  data-role="footer" class="ui-btn" data-position="fixed">
        <div data-role="navbar">
            <ul>
                <li><a href="#"  onclick="reset()" data-icon="refresh">重置</a></li>
                <li><a href="#"  onclick="submit()" data-icon="check">传送</a></li>
            </ul>
        </div>
    </div>

    <!--ImagePanel-->
    <div id="imagePanel" data-role="content">

    </div>
</div>

<div id="product_list"  data-role="page">

<!--Item-->
<div id="product_list_item" data-role="content">
    <ul data-role="listview" data-inset="true">
        <li><a id="firm" href="#" onclick="itemClick('firm',1)">
            <img src="images/information/product/firm.jpg">
            <h2>企业组织</h2>
            <p>相关责任企业或第三方组织机构</p></a></li>
        <li><a id="farm" href="#" onclick="itemClick('farm',1)">
            <img src="images/information/product/farm.jpg">
            <h2>农场</h2>
            <p>农产品具体种植地</p></a></li>
        <li><a id="plot" href="#" onclick="itemClick('plot',1)">
            <img src="images/information/product/plot.jpg">
            <h2>种植地块</h2>
            <p>有利于种植规划的一种区域划分</p></a></li>
        <li><a id="farmer" href="#" onclick="itemClick('farmer',1)">
            <img src="images/information/product/farmer.jpg">
            <h2>农户、工作人员</h2>
            <p>种植者、工作人员的相关信息</p></a></li>
        <li><a id="product" href="#" onclick="itemClick('product',1)">
            <img src="images/information/product/product.jpg">
            <h2>种植产品</h2>
            <p>某种植产品的具体信息</p></a></li>
        <li><a id="seed" href="#" onclick="itemClick('seed',1)">
            <img src="images/information/product/seed.jpg">
            <h2>种子选取</h2>
            <p></p></a></li>
    </ul>
</div>

<!--Firm-->
<div id="firm" data-role="content">


    <table><tr>
        <td><label for="">公司编号:</label></td>
        <td><input type="text" name="firm_id"></td>
    </tr>

        <tr>
            <td><label for="">公司名称:</label></td>
            <td><input type="text" name="firm_name"></td>
        </tr>

        <tr>
            <td><label for="">描述:</label></td>
            <td><input type="text" name="firm_info"></td>
        </tr>

        <tr>
            <td><label for="">备注:</label></td>
            <td><input type="text" name="firm_memo"></td>
        </tr></table>

</div>

<!--Farm-->
<div id="farm" data-role="content">

    <table><tr>
        <td><label for="">编号:</label></td>
        <td><input type="text" name="farm_id"></td>
    </tr>

        <tr>
            <td><label for="" >名称:</label></td>
            <td><input type="text" name="farm_name"></td>
        </tr>

        <tr>
            <td><label for="">农场主:</label></td>
            <td><input  type="text" name="farm_owner"></td>
        </tr>

        <tr>
            <td><label for="">地址:</label></td>
            <td><input  type="text" name="farm_addr"></td>
        </tr>

        <tr>
            <td><label for="" >介绍:</label></td>
            <td><input type="text" name="farm_info"></td>
        </tr>

        <tr>
            <td><label for="" >联系方式:</label></td>
            <td><input type="text" name="farm_contact"></td>
        </tr></table>
</div>

<!--Plot-->
<div id="plot" data-role="content">

    <table><tr>
        <td><label for="">编号：</label></td>
        <td><input type="text" name="plot_id"></td>
    </tr>

        <tr>
            <td><label for="">名称:</label></td>
            <td><input type="text" name="plot_name"></td>
        </tr>

        <tr>
            <td><label for="">农场编号:</label></td>
            <td><input type="text" name="farm_id"></td>
        </tr>

        <tr>
            <td><label for="">农场名称:</label></td>
            <td><input type="text" name="farm_name"></td>
        </tr>

        <tr>
            <td><label for="">规模:</label></td>
            <td><input type="text" name="plot_size"></td>
        </tr>
        </table>

</div>

<!--Farmer-->
<div id="farmer" data-role="content">

    <table><tr>
        <td><label for="">姓名:</label></td>
        <td><input type="text" name="farmer_name"></td>
    </tr>

        <tr>
            <td><label for="">联系方式:</label></td>
            <td><input type="text" name="farmer_"></td>
        </tr>

        <tr>
            <td><label for="">个人信息:</label></td>
            <td><input type="text" name="farm_id"></td>
        </tr>
	</table>
</div>

<!--Product-->
<div id="product" data-role="content">

    <table><tr>
        <td><label for="">编号:</label></td>
        <td><input type="text" name="product_id"></td>
    </tr>

        <tr>
            <td><label for="">名称:</label></td>
            <td><input type="text" name="product_name"></td>
        </tr>

        <tr>
            <td><label for="">种子选取:</label></td>
            <td><input type="text" name="seed_id"></td>
        </tr>

        <tr>
            <td><label for="">生产源地:</label></td>
            <td><input type="text" name="farm_id">
                <input type="text" name="plot_id">
            </td>
        </tr>

        <tr>
            <td><label for="">介绍:</label></td>
            <td><input type="text" name="product_info"></td>
        </tr>

        <tr>
            <td><label for="">种植时间:</label></td>
            <td><input type="text" name="product_plant"></td>
        </tr>

        <tr>
            <td><label for="">收获时间:</label></td>
            <td><input type="text" name="product_harvest"></td>
        </tr></table>

</div>

<!--Seed-->
<div id="seed" data-role="content">

    <table><tr>
        <td><label for="">编号:</label></td>
        <td><input type="text" name="seed_id"></td>
    </tr>

        <tr>
            <td><label for="">种子名称:</label></td>
            <td><input type="text" name="seed_name"></td>
        </tr>

        <tr>
            <td><label for="">购买时间:</label></td>
            <td><input type="text" name="seed_buy"></td>
        </tr>

        <tr>
            <td><label for="">购买证明:</label></td>
            <td><input type="text" name="seed_certify"></td>
        </tr>

        <tr>
            <td><label for="">其他信息:</label></td>
            <td><input type="text" name="seed_info"></td>
        </tr></table>

</div>

</div>

<div id="inputs_list" data-role="page">

<!--Item-->
<div id="inputs_list_item" data-role="content">
    <ul data-role="listview" data-inset="true">
        <li><a id="devices" href="#" onclick="itemClick('devices',1)">
            <img src="">
            <h2>设施投入:</h2>
            <p>种植设备、作业工具信息</p></a></li>
        <li><a id="fertilizer" href="#" onclick="itemClick('fertilizer',1)">
            <img src="">
            <h2>肥料:</h2>
            <p>化肥、有机肥使用信息</p></a></li>
        <li><a id="irrigation" href="#" onclick="itemClick('irrigation',1)">
            <img src="">
            <h2>灌溉水源:</h2>
            <p>灌溉水检测信息</p></a></li>
        <li><a id="soil" href="#" onclick="itemClick('soil',1)">
            <img src="">
            <h2>土壤:</h2>
            <p>土壤检测信息</p></a></li>
        <li><a id="air" href="#" onclick="itemClick('air',1)">
            <img src="">
            <h2>空气状况:</h2>
            <p>空气湿度、污染等情况</p></a></li>
    </ul>
</div>

<!--Devices-->
<div id="devices">

    <table><tr>
        <td><label for="">1:</label></td>
        <td><input></td>
    </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr></table>

</div>

<!--Fertilizer-->
<div id="fertilizer" data-role="content">

    <table><tr>
        <td><label for="">1:</label></td>
        <td><input></td>
    </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr></table>

</div>

<!--Pesticide-->
<div id="pesticide" data-role="content">

    <table><tr>
        <td><label for="">1:</label></td>
        <td><input></td>
    </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr></table>

</div>

<!--Irrigation-->
<div id="irrigation" data-role="content">
    <table><tr>
        <td><label for="">1:</label></td>
        <td><input></td>
    </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr></table>
</div>

<!--Soil-->
<div id="soil" data-role="content">

    <table><tr>
        <td><label for="">1:</label></td>
        <td><input></td>
    </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr></table>

</div>

<!--Air-->
<div id="air" data-role="content">

    <table><tr>
        <td><label for="">1:</label></td>
        <td><input></td>
    </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

        <tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr></table>

</div>

</div>

<div id="environment_list" data-role="page">

    <!--Item-->
    <div id="environment_list_item" data-role="content">
        <ul data-role="listview" data-inset="true">
            <li><a id="temperature" href="#" onclick="itemClick('temperature',1)">
                <img src="">
                <h2></h2>
                <p></p>temperature</a></li>
            <li><a id="humidity" href="#" onclick="itemClick('humidity',1)">
                <img src="">
                <h2></h2>
                <p></p>humidity</a></li>
        </ul>
    </div>

    <!--Temperature-->
    <div id="temperature" data-role="content">

        <table><tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr></table>

    </div>

    <!--Humidity-->
    <div id="humidity" data-role="content">

        <table><tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr></table>

    </div>
</div>

<div id="operation_list" data-role="page">

    <!--Item-->
    <div id="operation_list_item" data-role="content">
        <ul data-role="listview" data-inset="true">
            <li><a id="fertilize" href="#" onclick="itemClick('fertilize',1)">
                <img src="">
                <h2></h2>
                <p></p>fertilize</a></li>
            <li><a id="pest" href="#" onclick="itemClick('pest',1)">
                <img src="">
                <h2></h2>
                <p></p>pest</a></li>
            <li><a id="irrigate" href="#" onclick="itemClick('irrigate',1)">
                <img src="">
                <h2></h2>
                <p></p>irrigate</a></li>
            <li><a id="operator" href="#" onclick="itemClick('operator',1)">
                <img src="">
                <h2></h2>
                <p></p>operator</a></li>
        </ul>
    </div>

    <!--Fertilize-->
    <div id="fertilize" data-role="content">

        <table><tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr></table>

    </div>

    <!--Pest-->
    <div id="pest" data-role="content">

        <table><tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr></table>

    </div>

    <!--Irrigate-->
    <div id="irrigate" data-role="content">

        <table><tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr></table>

    </div>

    <!--Operator-->
    <div id="operator" data-role="content">

        <table><tr>
            <td><label for="">1:</label></td>
            <td><input></td>
        </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr>

            <tr>
                <td><label for="">1:</label></td>
                <td><input></td>
            </tr></table>

    </div>

</div>

</body>

<script>
    var viewStack=[];
    var lastView=-1
            ,nowView=1;
    var image_count=0;
    
    var _isInput=0;
    //food.dialogs.showAlert("添加图片成功","提示","确定");

    function itemClick(text,isInput){
        var content=$("div#content");
        var div_len=content.children('div').length;
        if(div_len!=0){
            lastView++;
            viewStack[lastView]=new Array(div_len);
            content.children("div").each(function(i){
                viewStack[lastView][i]=$(this).attr("id");
            });
        }else {
            lastView=0;
        }
        var item=$("div#"+text).clone().attr({"id":text});
        content.empty();
        content.append(item).trigger("create");
        if(isInput==1){
        	_isInput=1;
            food.upload.initUpload();
            content.append($("div#footer").clone(true)).trigger("create");
        }
        div_len=content.children('div').length;
        if(div_len!=0){
            viewStack[nowView]=new Array(div_len);
            content.children("div").each(function(i){
                viewStack[nowView][i]=$(this).attr("id");
            });
            nowView++;
        }else {
            lastView=0;
        }
    }

    function back(){
        if(lastView>=0){
            var content=$("div#content");
            var last;
            content.empty();
            for(var i=0;i<viewStack[lastView].length;i++){
                last=$("div#"+viewStack[lastView][i]).clone();
                content.append(last).trigger("create");
            }
            lastView--;
        }else{
            return ;
        }
    }

    function getText(){
        var jsn={};
        $("#content").find(":input").each(function(){
            jsn[$(this).attr("name")]=$(this).val();
        });
        return jsn;
    }

    function resume(jsn){
        $("#content").find(":input").each(function(){
            $(this).val(jsn[$(this).attr("name")]);
        });
    }

    function reset(){
        $("#content").find(":input").val("");
    }

    function submit(){
        var obj;
        food.upload.onSubmit(obj,getText());
    }

    function addList(){
    	if($("div#content").find(":input").length!=0){
        	var addList= $("div#addList");
        	if(addList.length!=0){
            	addList.detach();
        	}else{
            	var h_height=$("div#foodapp_header").css("height");
            	$("div#foodapp").append(
                    $("div#addList_Tem").clone().
                            attr({"id":"addList"}).
                            css({"position":"absolute","width":"30%","top":h_height,"height":"20%","right":"2%"})
            	).trigger("create");
        	}
    	}
    }

    var current_jsn;
    function showAddView(add){
        $("div#addList").detach();
        if($("div#content").find(":input").length!=0){
            current_jsn=getText();
            itemClick(add,0);
        }
    }

    function addImage(type){
        food.image.initImage();
        food.upload.addImage(type,image_count,function(){
            image_count++;
            back();
            resume(current_jsn);
            //food.dialogs.showAlert("添加图片成功","提示","确定");
            //food.dialogs.showConfirm("添加图片成功","提示",["确定","返回"]);
        });
    }

    function scanner(launcher){
        food.scanner[launcher]();
    }
</script>
</html>